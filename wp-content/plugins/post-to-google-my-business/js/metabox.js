!function(t){var e={};function o(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=19)}({0:function(t,e){!function(){t.exports=this.jQuery}()},1:function(t,e,o){"use strict";e.a=function(t,e){e||(e="notice-warning");var o=document.createElement("div");o.classList.add("notice","is-dismissible",e);var i=document.createElement("p");i.appendChild(document.createTextNode(t)),o.appendChild(i);var s=document.createElement("button");s.setAttribute("type","button"),s.classList.add("notice-dismiss");var n=document.createElement("span");n.classList.add("screen-reader-text"),n.appendChild(document.createTextNode("Dismiss this notice")),s.appendChild(n),o.appendChild(s);var a=document.getElementsByClassName("mbp-table-head")[0];a.parentNode.insertBefore(o,a),s.addEventListener("click",(function(){o.parentNode.removeChild(o)})),jQuery("html, body").animate({scrollTop:jQuery(o).offset().top-300},1e3)}},19:function(t,e,o){"use strict";o.r(e),o.d(e,"AJAX_CALLBACK_PREFIX",(function(){return a}));var i=o(0),s=o(5),n=o(1),a=mbp_localize_script.AJAX_CALLBACK_PREFIX,r=mbp_localize_script.POST_EDITOR_DEFAULT_FIELDS,c=new s.a(!0,a,r),p=i(".mbp-post-form-container"),l=i("#post_text"),d={metaVideoButton:i("#meta-video-button"),metaImageButton:i("#meta-image-button"),publishPostButton:i("#mbp-publish-post"),draftPostButton:i("#mbp-draft-post"),newPostButton:i("#mbp-new-post"),cancelPostButton:i("#mbp-cancel-post"),editTemplateButton:i("#mbp-edit-post-template")},u="create_post",m="edit_post",b="edit_template",h=u,f=!1;function _(t,e){c.resetForm(),d.publishPostButton.html(mbp_localize_script.publish_button),e?(f=t,h=m):(h=u,f=!1),p.slideUp("slow");var o={action:"mbp_load_post",mbp_post_id:t,mbp_post_nonce:mbp_localize_script.post_nonce};i.post(ajaxurl,o,(function(t){t.error?Object(n.a)(t.error,"notice-error"):t.success&&(c.loadFormFields(t.post.form_fields),d.draftPostButton.show(),f&&"publish"===t.post.post_status&&(d.publishPostButton.html(mbp_localize_script.update_button),d.draftPostButton.hide()),t.has_error&&Object(n.a)(t.has_error,"notice-error"),i.event.trigger({type:"mbpLoadPost",fields:t.post.form_fields}),p.slideDown("slow"),l.trigger("keyup"))}))}d.newPostButton.click((function(t){t.preventDefault(),d.publishPostButton.html(mbp_localize_script.publish_button),p.slideUp("slow"),f=!1,c.resetForm(),c.loadDefaultFormFields(),p.slideDown("slow"),d.draftPostButton.show(),h=u})),d.editTemplateButton.click((function(t){t.preventDefault(),function(){c.resetForm(),h=b,p.slideUp("slow"),d.draftPostButton.hide(),d.publishPostButton.html(mbp_localize_script.save_template);var t={action:"mbp_load_autopost_template",mbp_post_nonce:mbp_localize_script.post_nonce,mbp_post_id:mbp_localize_script.post_id};i.post(ajaxurl,t,(function(t){t.error?Object(n.a)(t.error,"notice-error"):t.success&&(t.data.fields&&c.loadFormFields(t.data.fields),p.slideDown("slow"),i.event.trigger({type:"mbpLoadAutopostTemplate"}))}))}()})),d.cancelPostButton.click((function(t){t.preventDefault(),p.slideUp("slow")})),i("#publish, #original_publish").click((function(t){(p=i(p.selector)).not(":visible")||(confirm(mbp_localize_script.publish_confirmation)?d.publishPostButton.trigger("click"):d.draftPostButton.trigger("click"))})),i("#mbp-publish-post, #mbp-draft-post").click((function(t){t.preventDefault();var e=this;i(e).html(mbp_localize_script.please_wait).attr("disabled",!0);var o=!1;"mbp-draft-post"===this.id&&(o=!0);var s={action:"mbp_new_post",mbp_serialized_fieldset:i("fieldset#mbp-post-data").serialize(),mbp_post_id:mbp_localize_script.post_id,mbp_post_nonce:mbp_localize_script.post_nonce,mbp_editing:f,mbp_draft:o,mbp_data_mode:h};return i.post(ajaxurl,s,(function(t){!1===t.success?Object(n.a)(t.data.error,"notice-error"):t.success&&!o&&p.slideUp("slow"),h!==b&&(f?i(".mbp-existing-posts tbody tr[data-postid='"+f+"']").replaceWith(t.data.row):i(".mbp-existing-posts tbody").prepend(t.data.row).show("slow"),i(".mbp-existing-posts .no-items").hide(),f=t.data.id),o?i(e).html(mbp_localize_script.draft_button).attr("disabled",!1):i(e).html(mbp_localize_script.publish_button).attr("disabled",!1)})),!0})),i(".mbp-existing-posts").on("click","a.mbp-action",(function(t){t.preventDefault();var e=i(this).closest("tr").data("postid");switch(i(this).data("action")){case"edit":_(e,!0);break;case"postlist":!function(t){i("#mbp-created-post-dialog");var e=i("#mbp-created-post-table"),o={action:"mbp_get_created_posts",mbp_post_id:t,mbp_post_nonce:mbp_localize_script.post_nonce};i.post(ajaxurl,o,(function(t){t.error?Object(n.a)(t.error,"notice-error"):t.success&&(e.html(t.data.table),tb_show("Created posts","#TB_inline?width=600&height=300&inlineId=mbp-created-post-dialog"),i("#TB_ajaxContent").attr("style",""))}))}(e);break;case"duplicate":_(e,!1);break;case"trash":!function(t){var e={action:"mbp_delete_post",mbp_post_id:t,mbp_post_nonce:mbp_localize_script.post_nonce};i.post(ajaxurl,e,(function(t){return!!t.success||(Object(n.a)(t.data.error,"notice-error"),!1)}))}(e),f===e&&p.slideUp("slow");var o=i(this).closest("tr");o.hide("slow"),o.remove(),i(".mbp-post").length<=0&&i(".mbp-existing-posts .no-items").show()}}))},4:function(t,e,o){"use strict";var i=o(0);e.a=function(t,e){var o=this,s=i(".mbp-business-selector",t),n=i(".mbp-location-blocked-info",t),a=i(".refresh-api-cache",t),r=i("input:checked",s);i.extend(i.expr[":"],{containsi:function(t,e,o,i){return(t.textContent||t.innerText||"").toLowerCase().indexOf((o[3]||"").toLowerCase())>=0}}),i(".mbp-filter-locations",t).keyup((function(){var e=i(this).val();i(".mbp-business-selector tr.mbp-business-item",t).hide().filter(":containsi("+e+")").show()})),i(".mbp-select-all-locations",t).click((function(e){e.preventDefault(),i(".mbp-checkbox-container input:checkbox:visible",t).prop("checked",!0)})),i(".mbp-select-no-locations",t).click((function(e){e.preventDefault(),i(".mbp-checkbox-container input:checkbox:visible",t).prop("checked",!1)})),this.checkForDisabledLocations=function(){i("input:disabled",s).length?n.show():n.hide()},this.checkForDisabledLocations(),this.refreshBusinesses=function(n,r){var c={action:e+"_refresh_locations",refresh:n=n||!1,selected:r};s.empty(),i.post(ajaxurl,c,(function(e){s.replaceWith(e),s=i(".mbp-business-selector",t),a.html(mbp_localize_script.refresh_locations).attr("disabled",!1),o.checkForDisabledLocations()}))},"0"===r.val()&&this.refreshBusinesses(!1),a.click((function(t){var e=[];i.each(i("input:checked",s),(function(){e.push(i(this).val())})),t.preventDefault(),o.refreshBusinesses(!0,e),a.html(mbp_localize_script.please_wait).attr("disabled",!0)}))}},5:function(t,e,o){"use strict";var i=o(1),s=o(0),n=function(t,e){var o,n;e=e||"mbp_form_fields";var a=this,r="Add photo or video",c="Invalid media type selected, only images and videos are supported",p="Currently the Google My Business API only supports uploading a single image or video to a post",l=wp.media({frame:"post",state:"insert",multiple:!1});this.setFieldName=function(t){e=t};var d=function(){l.open()},u=function(t){t.preventDefault(),this.closest("div").remove()};this.countItems=function(){return s(".item.item-container").length},this.clearItems=function(){s(".item.item-container").remove()},this.loadItem=function(t,o,r){if(a.countItems()>=1)Object(i.a)(p);else{var c=s("<div>",{class:"item item-container"});if("VIDEO"!==t&&r){var l=s("<img>",{class:"item-image",src:r});c.append(l)}else{var d=s("<div>",{class:"external-image"});c.append(d)}var m=s("<input>",{type:"hidden",value:o,name:e+"[mbp_post_attachment]"}),b=s("<input>",{type:"hidden",value:t,name:e+"[mbp_attachment_type]"}),h=s("<button>");h.html('<span class="dashicons dashicons-trash"></span>'),c.append(h),c.append(m),c.append(b),h.click(u),n.append(c)}},this.loadItems=function(t){},l.on("select",(function(){var t=l.state().props.toJSON();t.width?a.loadItem("PHOTO",t.url,t.url):a.loadItem("VIDEO",t.url)})),l.on("insert",(function(){l.state().get("selection").toJSON().forEach((function(t){"image"===t.type?a.loadItem("PHOTO",t.url,t.sizes.medium.url):"video"===t.type?a.loadItem("VIDEO",t.url,t.thumb.src):Object(i.a)(c)}))})),n=s("<div>",{class:"media-uploader-container"}),t.append(n),(o=s("<div>",{class:"item new-item-button"})).html("<div class='new-item-text'><span class=\"dashicons dashicons-camera\"></span><br />"+r+"</div>"),o.click(d),n.append(o)},a=o(4);e.a=function(t,e,o){var i=t||!1,r=this,c=s("#post_text"),p=s(".mbp-post-form-container"),l="mbp_form_fields";(this.mediaUploader=new n(s(".mediaupload_selector")),new a.a(s(".mbp-business-selector-container"),e),this.setFieldPrefix=function(t){l=t},this.switch_tab=function(t){s(".nav-tab",p).removeClass("nav-tab-active"),s(t).addClass("nav-tab-active"),s(".mbp-fields tr").not(".mbp-button-settings").hide(),s(".mbp-fields tr."+s(t).data("fields")).not(".mbp-button-settings").show(),s("input.mbp-topic-type").val(s(t).data("topic"))},s(".nav-tab",p).click((function(t){t.preventDefault(),r.switch_tab(this)})),s(".mbp-toggle-advanced").click((function(t){t.preventDefault();var e=s(".mbp-advanced-post-settings");e.is(":hidden")?localStorage.openAdvanced=JSON.stringify(!0):localStorage.openAdvanced=JSON.stringify(!1),e.slideToggle("slow")})),localStorage.openAdvanced&&!0===JSON.parse(localStorage.openAdvanced))&&s(".mbp-advanced-post-settings").show();c.change((function(){s(this).trigger("keyup")})),c.keyup((function(){var t=s(".mbp-character-count"),e=s(this).val().length,o=s(this).val().split(" ").length-1;t.text(e),e>1500?t.css("color","red"):t.css("color","inherit"),s(".mbp-word-count").text(o)}));var d=!1;if(s("#mbp_button").change((function(){this.checked?(s(".mbp-button-settings").fadeIn("slow"),d=!0):(s(".mbp-button-settings").fadeOut("slow"),d=!1)})),s(".mbp-button-type").change((function(){var t=s(".mbp-button-url");"CALL"!==s(".mbp-button-type:checked").val()?d&&t.fadeIn("slow"):t.fadeOut("slow")})),this.loadFormFields=function(t){s.each(t,(function(t,e){var o=s('[name="'+l+"["+t+']"], [name="'+l+"["+t+'][]"]');o.is(":checkbox")||o.is(":radio")?(o.attr("checked",!1),s.isArray(e)?s.each(e,(function(e,o){s('[name="'+l+"["+t+'][]"][value="'+o+'"]').attr("checked",!0)})):("1"!==e&&"on"!==e||(e=!0),"boolean"==typeof e?s('[name="'+l+"["+t+']"]').attr("checked",e):s('[name="'+l+"["+t+']"][value="'+e+'"]').attr("checked",!0))):o.val(e),o.change()})),t.mbp_post_attachment&&t.mbp_attachment_type&&this.mediaUploader.loadItem(t.mbp_attachment_type,t.mbp_post_attachment,t.mbp_post_attachment);var e=s('a[data-topic="'+t.mbp_topic_type+'"]');this.switch_tab(e)},this.resetForm=function(){this.mediaUploader.clearItems()},this.loadDefaultFormFields=function(){this.loadFormFields(o)},!i){s("#mbp_button").trigger("change"),s(".mbp-button-type").trigger("change"),s(c).trigger("keyup");var u=s("input.mbp-topic-type").val(),m=s('a[data-topic="'+u+'"]');this.switch_tab(m)}}}});